import{w as u}from"./D8pH6ZKL.js";import{b as l}from"./DZFsq0ZI.js";const g=!0,d=g,r={isAuthenticated:!1,currentUser:null,token:null,isLoading:!0};function f(){const{subscribe:n,set:i,update:e}=u(r);return{subscribe:n,init:()=>{const a=localStorage.getItem("auth_token");e(a?o=>({...o,isAuthenticated:!0,token:a,isLoading:!1}):o=>({...o,isLoading:!1}))},login:async(a,o)=>{e(t=>({...t,isLoading:!0}));try{const t=await fetch(`${l}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Email:a,Password:o})});if(!t.ok)throw new Error("Login failed");const s=await t.json();return d&&localStorage.setItem("auth_token",s.tokens.accessToken),e(c=>({...c,isAuthenticated:!0,currentUser:s.user,token:s.tokens.accessToken,isLoading:!1})),{success:!0}}catch(t){return e(s=>({...s,isLoading:!1})),{success:!1,error:t.message}}},logout:()=>{localStorage.removeItem("auth_token"),i({...r,isLoading:!1})}}}const h=f();localStorage.getItem("auth_token")&&h.init();export{h as a};
